# 🎯 基础风格继承功能 - 测试指南

## 🔥 新功能概述

现在 Clang-Format 可视化编辑器支持智能的基础风格继承！解决了之前 Microsoft 风格缩进被意外覆盖的问题。

## ✨ 核心特性

### 1. 智能继承检测
- 当选择基础风格（如 Microsoft）时，相关配置项会自动继承该风格的默认值
- 输入框显示为空，用占位符提示继承的值
- 只有当用户主动输入时，才会覆盖基础风格的设置

### 2. 可视化继承状态
- 🔗 **继承指示器**: 显示当前正在继承基础风格
- 📝 **占位符提示**: `基于 Microsoft 风格 (4)` 这样的友好提示
- 💡 **继承信息**: 明确显示从哪个风格继承了什么值
- 🎨 **样式区分**: 继承状态的输入框使用虚线边框和不同背景色

### 3. 灵活的覆盖机制
- 用户可以随时输入值来覆盖继承的设置
- 清空输入框会恢复到继承状态
- 预览会实时反映当前生效的值（无论是继承还是用户设置）

## 🧪 测试场景

### 测试 1: Microsoft 风格继承
1. 打开 Clang-Format 编辑器
2. 选择 `基础风格` → `Microsoft`
3. 观察 `缩进宽度` 字段：
   - ✅ 输入框应该是空的
   - ✅ 占位符应显示: `基于 Microsoft 风格 (4)`
   - ✅ 应有 🔗 继承指示器
   - ✅ 下方应显示继承信息
   - ✅ 预览代码应显示 4 格缩进

### 测试 2: 覆盖继承值
1. 在 `缩进宽度` 输入框中输入 `2`
2. 观察变化：
   - ✅ 继承指示器消失
   - ✅ 继承信息消失
   - ✅ 输入框变为实心边框
   - ✅ 预览代码变为 2 格缩进

### 测试 3: 恢复继承
1. 清空 `缩进宽度` 输入框
2. 观察恢复：
   - ✅ 重新显示继承指示器
   - ✅ 重新显示继承信息
   - ✅ 预览恢复为 4 格缩进

### 测试 4: 不同风格的继承
- **Google 风格**: IndentWidth 应继承为 2
- **WebKit 风格**: IndentWidth 应继承为 4
- **LLVM 风格**: IndentWidth 应继承为 2

### 测试 5: 保存行为验证
1. 选择 Microsoft 风格（不覆盖任何值）
2. 点击保存
3. 验证生成的 .clang-format 文件：
   ```yaml
   ---
   BasedOnStyle: Microsoft
   # 应该没有 IndentWidth: 4，因为这是继承的
   ```

## 🎨 视觉效果说明

### 继承状态的输入框
```
┌─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┐
│  [空]                              │  🔗
│  基于 Microsoft 风格 (4)           │
└─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘
💡 当前继承自 Microsoft 风格，输入数值可覆盖此设置
```

### 用户设置状态的输入框
```
┌─────────────────────────────────────┐
│  4                                  │
│                                     │
└─────────────────────────────────────┘
```

## 🔧 支持的继承配置项

### 数字类型
- `IndentWidth` - 缩进宽度
- `TabWidth` - Tab 宽度
- `ColumnLimit` - 行长度限制
- `ContinuationIndentWidth` - 继续行缩进宽度

### 枚举类型
- `UseTab` - Tab 使用方式
- `BreakBeforeBraces` - 大括号换行风格
- 其他受基础风格影响的枚举值

## 🐛 调试信息

在浏览器控制台中，关键配置项会输出详细的调试信息：
```
🔧 Clotho Debug - IndentWidth: {
  configValue: undefined,           // 用户没有设置
  shouldInherit: true,             // 应该继承
  inheritedValue: 4,               // 从 Microsoft 继承的值
  baseStyle: "Microsoft",          // 基础风格
  finalValue: 4                    // 最终生效的值
}
```

## 🎉 预期效果

现在当用户：
1. 选择 Microsoft 风格时，缩进会正确显示为 4，但不会保存 `IndentWidth: 4`
2. 只有主动修改缩进值时，才会在配置文件中明确指定
3. 可以随时通过清空输入框来恢复基础风格的继承

这完全解决了之前"选择 Microsoft 风格后，保存时缩进被改为 2" 的问题！

## 🔮 技术实现

### 核心函数
- `shouldInheritFromStyle()` - 判断是否应该继承
- `getInheritedValue()` - 获取继承的值
- `getEffectiveValue()` - 获取最终生效的值（继承优先级）

### 风格默认值数据库
```typescript
const STYLE_DEFAULTS = {
    'Microsoft': {
        IndentWidth: 4,
        TabWidth: 4,
        UseTab: 'Never',
        BreakBeforeBraces: 'Allman',
        ColumnLimit: 120
    },
    // ... 其他风格
};
```

这个实现保持了 clang-format 原生的设计哲学：基础风格提供默认值，用户配置覆盖特定设置。
